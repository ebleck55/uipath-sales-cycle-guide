<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dynamic Personas Filtering Test</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-8">
  <div class="max-w-7xl mx-auto">
    <h1 class="text-3xl font-bold mb-6">Dynamic Personas Filtering Test</h1>
    
    <!-- Customer Information Selectors -->
    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-8">
      <!-- Vertical Selector -->
      <div class="bg-white p-4 rounded-lg shadow">
        <h3 class="font-semibold mb-3">Vertical</h3>
        <div class="space-y-2">
          <button class="industry-btn w-full px-3 py-2 text-sm font-medium rounded-md border-2 border-gray-200 transition-colors hover:border-gray-300" data-industry="">
            Clear Selection
          </button>
          <button class="industry-btn w-full px-3 py-2 text-sm font-medium rounded-md border-2 border-gray-200 transition-colors hover:border-gray-300" data-industry="banking">
            Banking
          </button>
          <button class="industry-btn w-full px-3 py-2 text-sm font-medium rounded-md border-2 border-gray-200 transition-colors hover:border-gray-300" data-industry="insurance">
            Insurance
          </button>
        </div>
      </div>

      <!-- LOB Selector -->
      <div class="bg-white p-4 rounded-lg shadow">
        <h3 class="font-semibold mb-3">Line of Business</h3>
        <select id="lob-selector" class="w-full px-3 py-2 text-sm bg-white border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500">
          <option value="">Loading...</option>
        </select>
      </div>

      <!-- Customer Type -->
      <div class="bg-white p-4 rounded-lg shadow">
        <h3 class="font-semibold mb-3">Customer Type</h3>
        <div class="space-y-2">
          <button class="customer-type-btn w-full px-3 py-2 text-sm font-medium rounded-md border-2 border-gray-200 transition-colors hover:border-gray-300" data-type="new-logo">
            New Logo
          </button>
          <button class="customer-type-btn w-full px-3 py-2 text-sm font-medium rounded-md border-2 border-gray-200 transition-colors hover:border-gray-300" data-type="existing">
            Existing
          </button>
        </div>
      </div>

      <!-- Deployment -->
      <div class="bg-white p-4 rounded-lg shadow">
        <h3 class="font-semibold mb-3">Deployment</h3>
        <select id="deployment-type" class="w-full px-3 py-2 text-sm bg-white border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500">
          <option value="">Select Deployment</option>
          <option value="on-prem">On-Premises</option>
          <option value="automation-suite">Automation Suite</option>
          <option value="automation-cloud">Automation Cloud</option>
        </select>
      </div>
    </div>

    <!-- Test Results -->
    <div class="bg-white p-6 rounded-lg shadow mb-8">
      <h2 class="text-xl font-semibold mb-4">Test Scenarios</h2>
      <div class="grid md:grid-cols-3 gap-4">
        <button onclick="testCapitalMarkets()" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700">
          Test: Capital Markets
        </button>
        <button onclick="testInsuranceClaims()" class="px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700">
          Test: Insurance Claims
        </button>
        <button onclick="testGeneralFinance()" class="px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700">
          Test: General Finance
        </button>
      </div>
    </div>

    <!-- Personas Display Container -->
    <div class="bg-white p-6 rounded-lg shadow">
      <div id="personas-container">
        <!-- Personas will be rendered here -->
        <p class="text-gray-500 text-center py-8">Select customer criteria above to see relevant personas...</p>
      </div>
    </div>

    <!-- Test Log -->
    <div class="mt-8 bg-gray-50 p-6 rounded-lg">
      <h3 class="text-lg font-semibold mb-4">Test Log</h3>
      <div id="test-log" class="space-y-2 max-h-64 overflow-y-auto">
        <p class="text-gray-600 text-sm">Test log will appear here...</p>
      </div>
    </div>
  </div>

  <!-- Include the personas functionality from main app -->
  <script src="timeline-app.js"></script>

  <script>
    let testManager;

    // Test functions
    function testCapitalMarkets() {
      logTest('Testing Capital Markets scenario...');
      
      // Select Banking vertical
      const bankingBtn = document.querySelector('[data-industry="banking"]');
      if (bankingBtn) {
        bankingBtn.click();
        setTimeout(() => {
          // Select Capital Markets LOB
          const lobSelector = document.getElementById('lob-selector');
          lobSelector.value = 'capital-markets';
          lobSelector.dispatchEvent(new Event('change'));
          
          setTimeout(() => {
            // Select existing customer
            const existingBtn = document.querySelector('[data-type="existing"]');
            if (existingBtn) existingBtn.click();
            
            logTest('Capital Markets test completed. Check personas above.');
          }, 100);
        }, 100);
      }
    }

    function testInsuranceClaims() {
      logTest('Testing Insurance Claims scenario...');
      
      // Select Insurance vertical
      const insuranceBtn = document.querySelector('[data-industry="insurance"]');
      if (insuranceBtn) {
        insuranceBtn.click();
        setTimeout(() => {
          // Select Claims Processing LOB
          const lobSelector = document.getElementById('lob-selector');
          lobSelector.value = 'claims-processing';
          lobSelector.dispatchEvent(new Event('change'));
          
          setTimeout(() => {
            // Select cloud deployment
            const deploymentSelector = document.getElementById('deployment-type');
            deploymentSelector.value = 'automation-cloud';
            deploymentSelector.dispatchEvent(new Event('change'));
            
            logTest('Insurance Claims test completed. Check personas above.');
          }, 100);
        }, 100);
      }
    }

    function testGeneralFinance() {
      logTest('Testing General Finance scenario...');
      
      // Clear vertical selection
      const clearBtn = document.querySelector('[data-industry=""]');
      if (clearBtn) {
        clearBtn.click();
        setTimeout(() => {
          // Select Finance LOB
          const lobSelector = document.getElementById('lob-selector');
          lobSelector.value = 'finance';
          lobSelector.dispatchEvent(new Event('change'));
          
          setTimeout(() => {
            // Select new logo customer
            const newLogoBtn = document.querySelector('[data-type="new-logo"]');
            if (newLogoBtn) newLogoBtn.click();
            
            logTest('General Finance test completed. Check personas above.');
          }, 100);
        }, 100);
      }
    }

    function logTest(message) {
      const testLog = document.getElementById('test-log');
      const timestamp = new Date().toLocaleTimeString();
      const logEntry = document.createElement('div');
      logEntry.className = 'text-sm text-gray-700';
      logEntry.innerHTML = `<span class="text-gray-400">[${timestamp}]</span> ${message}`;
      testLog.appendChild(logEntry);
      testLog.scrollTop = testLog.scrollHeight;
    }

    // Initialize when page loads
    document.addEventListener('DOMContentLoaded', () => {
      logTest('Initializing dynamic personas test...');
      
      // Wait for the main app to load
      setTimeout(() => {
        if (window.customerInfoManager) {
          testManager = window.customerInfoManager;
          logTest('✅ CustomerInfoManager loaded successfully');
          logTest('Ready for testing! Use the test buttons above or manually select criteria.');
        } else {
          logTest('❌ CustomerInfoManager not found. Make sure timeline-app.js is loaded.');
        }
      }, 500);
    });
  </script>
</body>
</html>